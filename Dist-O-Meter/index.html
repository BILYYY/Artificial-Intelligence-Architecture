<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dist‚Äëo‚ÄëMeter (No Electronics)</title>
  <style>
    :root{
      --bg:#0f172a; --card:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#22d3ee; --accent2:#a78bfa; --ok:#34d399; --warn:#f59e0b; --err:#ef4444;
      --shadow: 0 10px 30px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(160deg,#0b1022 0%,#0f172a 60%,#0b132b 100%);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;}
    header{max-width:1100px;margin:24px auto 12px;padding:0 16px}
    h1{font-size:clamp(28px,3.4vw,42px);line-height:1.1;margin:0 0 8px}
    .subtitle{color:var(--muted)}
    .wrap{max-width:1100px;margin:0 auto;padding:16px;display:grid;grid-template-columns:1fr;gap:16px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{background:linear-gradient(180deg,#0b1224,#0e152a);border:1px solid rgba(255,255,255,.06);border-radius:18px;box-shadow:var(--shadow);padding:16px}
    .card h2{margin:0 0 8px;font-size:clamp(18px,2.2vw,22px)}
    label{display:block;font-size:13px;color:var(--muted);margin:10px 0 6px}
    input,select,button,textarea{width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#0b1120;color:var(--text);font-size:15px}
    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--accent)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .hint{font-size:12px;color:var(--muted)}
    .pill{display:inline-flex;gap:8px;align-items:center;border:1px solid rgba(255,255,255,.08);padding:8px 12px;border-radius:999px;background:#0b1120}
    .btn{cursor:pointer;background:linear-gradient(90deg,var(--accent),var(--accent2));border:none;color:#04111f;font-weight:700;letter-spacing:.2px}
    .btn:active{transform:translateY(1px)}
    .btn-ghost{background:transparent;border-color:rgba(255,255,255,.15);color:var(--text)}
    .result{font-size:32px;font-weight:800}
    .mono{font-family:UI Monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    details{background:#0b1120;border:1px solid rgba(255,255,255,.08);padding:12px 14px;border-radius:12px}
    summary{cursor:pointer;font-weight:700}
    .footer{color:var(--muted);font-size:12px;text-align:center;margin:20px 0}
    .tag{font-size:11px;color:#0a1424;background:linear-gradient(90deg,#34d399,#22d3ee);display:inline-block;border-radius:999px;padding:5px 10px;font-weight:800}
    .two{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:980px){
      .two{grid-template-columns:1.1fr .9fr}
    }
    canvas{width:100%;height:220px;background:#0a1222;border-radius:12px;border:1px solid rgba(255,255,255,.06)}
    .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .kpi .card{padding:14px}
    .muted{color:var(--muted)}
    .ok{color:var(--ok)}.warn{color:var(--warn)}.err{color:var(--err)}
    .tiny{font-size:11px}
    .hr{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);margin:14px 0}
    code{background:#0b1224;padding:2px 6px;border-radius:8px;border:1px solid rgba(255,255,255,.08)}
  </style>
</head>
<body>
  <header>
    <h1>Dist‚Äëo‚ÄëMeter üìè ‚Äî no‚Äëelectronics distance estimator</h1>
    <div class="subtitle">Use a grid + angles to estimate distance to a target with your DIY Monster‚Äëcan viewer. Combines both methods and averages them for extra stability.</div>
  </header>

  <main class="wrap two">
    <section class="card">
      <h2>Inputs</h2>

      <div class="grid">
        <div class="card" style="grid-column: span 12">
          <h3 style="margin:0 0 8px">Method A ‚Äî Grid (similar triangles)</h3>
          <div class="row3">
            <div>
              <label>Real size of the feature you‚Äôre measuring <span class="hint">(cm)</span></label>
              <input id="realSize" type="number" step="0.01" placeholder="e.g. 30 (height of book)" />
            </div>
            <div>
              <label>Squares the feature spans on your grid <span class="hint">(count)</span></label>
              <input id="squaresCount" type="number" step="1" placeholder="e.g. 12" />
            </div>
            <div>
              <label>Size of one square <span class="hint">(cm)</span></label>
              <input id="squareSize" type="number" step="0.01" value="1" />
            </div>
          </div>
          <div class="row">
            <div>
              <label>Distance from eye to grid (can length) <span class="hint">L in cm</span></label>
              <input id="eyeToGrid" type="number" step="0.01" placeholder="Measure inside length of can" />
            </div>
            <div>
              <label class="hint">Formula: <code>D_grid = (RealSize √ó L) / (Squares √ó SquareSize)</code></label>
              <div class="tiny muted">Count squares along the same dimension as the real size (height with height or width with width).</div>
            </div>
          </div>
        </div>

        <div class="card" style="grid-column: span 12">
          <h3 style="margin:0 0 8px">Method B ‚Äî Two‚Äëangle triangulation</h3>
          <div class="row3">
            <div>
              <label>Baseline between viewpoints <span class="hint">b in cm</span></label>
              <input id="baseline" type="number" step="0.01" placeholder="e.g. 20 (shift device sideways)" />
            </div>
            <div>
              <label>Angle from left position <span class="hint">Œ∏‚ÇÅ in ¬∞</span></label>
              <input id="angle1" type="number" step="0.01" placeholder="e.g. 8" />
            </div>
            <div>
              <label>Angle from right position <span class="hint">Œ∏‚ÇÇ in ¬∞</span></label>
              <input id="angle2" type="number" step="0.01" placeholder="e.g. 7" />
            </div>
          </div>
          <div class="row">
            <div>
              <label class="hint">Formula: <code>D_tri = b / (tan Œ∏‚ÇÅ + tan Œ∏‚ÇÇ)</code></label>
              <div class="tiny muted">Stand roughly facing the target both times. Measure the angle from your forward line to the target line.</div>
            </div>
            <div>
              <label>Unit for output</label>
              <select id="unit">
                <option value="cm">centimeters (cm)</option>
                <option value="m">meters (m)</option>
              </select>
            </div>
          </div>
        </div>

        <div style="grid-column: span 12; display:flex; gap:12px; align-items:center; justify-content:flex-end">
          <button class="btn-ghost pill" id="demoBtn">Fill demo values</button>
          <button class="btn pill" id="calcBtn">Calculate distance</button>
        </div>
      </div>

      <div class="hr"></div>

      <div class="kpi">
        <div class="card">
          <div class="muted tiny">Grid estimate</div>
          <div class="result" id="gridOut">‚Äî</div>
          <div class="tiny muted">via similar triangles</div>
        </div>
        <div class="card">
          <div class="muted tiny">Triangulation estimate</div>
          <div class="result" id="triOut">‚Äî</div>
          <div class="tiny muted">two angles + baseline</div>
        </div>
        <div class="card">
          <div class="muted tiny">Combined (average)</div>
          <div class="result" id="avgOut">‚Äî</div>
          <div class="tiny muted">(Grid + Triangulation) √∑ 2</div>
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="btn-ghost" id="exportBtn">Export inputs/results (JSON)</button>
        <button class="btn-ghost" id="resetBtn">Reset</button>
      </div>

    </section>

    <aside class="card">
      <h2>Build guide & user manual</h2>

      <details open>
        <summary>What you built (Monster‚Äëcan viewer)</summary>
        <ol class="tiny" style="line-height:1.45">
          <li>Cut the bottom off a Monster bottle/can so you have a tube. Fix a paper grid (1√ó1 cm squares) at the wide/open end (the end away from your eye). This is the aperture plane.</li>
          <li>Put your eye at the drinking end (like where you‚Äôd sip) ‚Äî that is the "lens"/eye point.</li>
          <li>Tape a small paper protractor near the eye end and a straw/skewer as a sight pipe to help align and read angles.</li>
          <li>Measure and record the inside length of the tube: <code>L</code> (cm). This is the distance from your eye to the grid.</li>
        </ol>
      </details>

      <details>
        <summary>How to take measurements</summary>
        <div class="tiny">
          <p><strong>Method A ‚Äî Grid:</strong> Look through the eye end. Choose one dimension of the target (height or width) that you know in real life (or can measure). Count how many grid squares the target spans <em>along that same dimension</em>. Enter: real size (cm), number of squares, square size (usually 1 cm), and L (tube length).</p>
          <p><strong>Method B ‚Äî Two‚Äëangle:</strong> Stand at point A facing forward. Aim the sight pipe at the target and read angle Œ∏‚ÇÅ from your straight‚Äëahead line. Slide sideways by a measured baseline <code>b</code> (e.g., 20 cm) to point B, keep facing forward, aim again and read Œ∏‚ÇÇ. Enter b, Œ∏‚ÇÅ, Œ∏‚ÇÇ.</p>
        </div>
      </details>

      <details>
        <summary>Tips for accuracy</summary>
        <ul class="tiny">
          <li>Keep the grid perpendicular to the tube; don‚Äôt let it tilt.</li>
          <li>Use the same eye position each time (mark a notch at the eye end).</li>
          <li>Smaller angles (under ~15¬∞) give more reliable tan() readings with a paper protractor.</li>
          <li>Repeat 3‚Äì5 times and average.</li>
        </ul>
      </details>
    </aside>
  </main>

  <footer class="footer">
    Dist‚Äëo‚ÄëMeter ‚Ä¢ MIT License ‚Ä¢ Works offline
  </footer>

  <script>
    const $ = (id)=>document.getElementById(id);
    const fmt = (x, unit)=> isFinite(x) ? (unit==='m' ? (x/100).toFixed(3)+' m' : x.toFixed(1)+' cm') : '‚Äî';

    function calc(){
      const realSize = parseFloat($("realSize").value);
      const squares = parseFloat($("squaresCount").value);
      const squareSize = parseFloat($("squareSize").value || '1');
      const L = parseFloat($("eyeToGrid").value);
      const b = parseFloat($("baseline").value);
      const a1 = parseFloat($("angle1").value) * Math.PI/180;
      const a2 = parseFloat($("angle2").value) * Math.PI/180;
      const unit = $("unit").value;

      let Dgrid = NaN, Dtri = NaN;
      if([realSize,squares,squareSize,L].every(v=>v>0)){
        Dgrid = (realSize * L) / (squares * squareSize);
      }
      if([b,a1,a2].every(v=>v>0)){
        const denom = Math.tan(a1) + Math.tan(a2);
        if(Math.abs(denom) > 1e-6) Dtri = b / denom; else Dtri = NaN;
      }
      const Davg = (isFinite(Dgrid) && isFinite(Dtri)) ? (Dgrid + Dtri)/2 : (isFinite(Dgrid) ? Dgrid : (isFinite(Dtri) ? Dtri : NaN));

      $("gridOut").textContent = fmt(Dgrid, unit);
      $("triOut").textContent = fmt(Dtri, unit);
      $("avgOut").textContent = fmt(Davg, unit);
    }

    $("calcBtn").addEventListener('click', calc);
    $("resetBtn").addEventListener('click', ()=>{
      ["realSize","squaresCount","squareSize","eyeToGrid","baseline","angle1","angle2"].forEach(id=> $(id).value = '');
      $("unit").value='cm';
      ["gridOut","triOut","avgOut"].forEach(id=> $(id).textContent='‚Äî');
    });

    $("demoBtn").addEventListener('click', ()=>{
      $("realSize").value = 30;     
      $("squaresCount").value = 12; 
      $("squareSize").value = 1;    
      $("eyeToGrid").value = 25;    
      $("baseline").value = 20;     
      $("angle1").value = 8;        
      $("angle2").value = 7;        
      $("unit").value = 'm';
      calc();
    });

    $("exportBtn").addEventListener('click', ()=>{
      const data = {
        realSize: $("realSize").value,
        squaresCount: $("squaresCount").value,
        squareSize: $("squareSize").value,
        eyeToGrid: $("eyeToGrid").value,
        baseline: $("baseline").value,
        angle1_deg: $("angle1").value,
        angle2_deg: $("angle2").value,
        unit: $("unit").value,
        results: {
          grid: $("gridOut").textContent,
          triangulation: $("triOut").textContent,
          average: $("avgOut").textContent
        }
      };
      const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'dist-o-meter-results.json'; a.click();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
